{"ast":null,"code":"import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"strategy-edit\"\n};\nvar _hoisted_2 = {\n  \"class\": \"header\"\n};\nvar _hoisted_3 = {\n  \"class\": \"editor-container\"\n};\nvar _hoisted_4 = {\n  \"class\": \"editor-tips\"\n};\nvar _hoisted_5 = {\n  \"class\": \"editor-container\"\n};\nvar _hoisted_6 = {\n  \"class\": \"editor-tips\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_input = _resolveComponent(\"el-input\");\n  var _component_el_form_item = _resolveComponent(\"el-form-item\");\n  var _component_MonacoEditor = _resolveComponent(\"MonacoEditor\");\n  var _component_el_tag = _resolveComponent(\"el-tag\");\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_el_form = _resolveComponent(\"el-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"h2\", null, _toDisplayString($options.isEdit ? '编辑策略' : '新建策略'), 1 /* TEXT */)]), _createVNode(_component_el_form, {\n    model: $data.form,\n    \"label-width\": \"120px\",\n    rules: $data.rules,\n    ref: \"formRef\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_el_form_item, {\n        label: \"策略名称\",\n        prop: \"name\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_input, {\n            modelValue: $data.form.name,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n              return $data.form.name = $event;\n            }),\n            placeholder: \"请输入策略名称\"\n          }, null, 8 /* PROPS */, [\"modelValue\"])];\n        }),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"策略描述\",\n        prop: \"description\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_input, {\n            modelValue: $data.form.description,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n              return $data.form.description = $event;\n            }),\n            type: \"textarea\",\n            placeholder: \"请输入策略描述\"\n          }, null, 8 /* PROPS */, [\"modelValue\"])];\n        }),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"SQL代码\",\n        prop: \"sqlCode\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_MonacoEditor, {\n            modelValue: $data.form.sqlCode,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n              return $data.form.sqlCode = $event;\n            }),\n            language: \"sql\",\n            options: $data.editorOptions,\n            onSave: $options.handleSave\n          }, null, 8 /* PROPS */, [\"modelValue\", \"options\", \"onSave\"])]), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_tag, {\n            size: \"small\"\n          }, {\n            \"default\": _withCtx(function () {\n              return _cache[4] || (_cache[4] = [_createTextVNode(\"按 Ctrl+S (Mac: Cmd+S) 保存\")]);\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_tag, {\n            size: \"small\",\n            type: \"info\"\n          }, {\n            \"default\": _withCtx(function () {\n              return _cache[5] || (_cache[5] = [_createTextVNode(\"支持 SQL 代码提示\")]);\n            }),\n            _: 1 /* STABLE */\n          })])];\n        }),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"Python代码\",\n        prop: \"pythonCode\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_MonacoEditor, {\n            modelValue: $data.form.pythonCode,\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n              return $data.form.pythonCode = $event;\n            }),\n            language: \"python\",\n            options: $data.editorOptions,\n            onSave: $options.handleSave\n          }, null, 8 /* PROPS */, [\"modelValue\", \"options\", \"onSave\"])]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_el_tag, {\n            size: \"small\"\n          }, {\n            \"default\": _withCtx(function () {\n              return _cache[6] || (_cache[6] = [_createTextVNode(\"按 Ctrl+S (Mac: Cmd+S) 保存\")]);\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_tag, {\n            size: \"small\",\n            type: \"info\"\n          }, {\n            \"default\": _withCtx(function () {\n              return _cache[7] || (_cache[7] = [_createTextVNode(\"支持 Python 代码提示\")]);\n            }),\n            _: 1 /* STABLE */\n          })])];\n        }),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, null, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: $options.handleSave\n          }, {\n            \"default\": _withCtx(function () {\n              return _cache[8] || (_cache[8] = [_createTextVNode(\"保存\")]);\n            }),\n            _: 1 /* STABLE */\n          }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n            onClick: $options.cancel\n          }, {\n            \"default\": _withCtx(function () {\n              return _cache[9] || (_cache[9] = [_createTextVNode(\"取消\")]);\n            }),\n            _: 1 /* STABLE */\n          }, 8 /* PROPS */, [\"onClick\"])];\n        }),\n        _: 1 /* STABLE */\n      })];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\", \"rules\"])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","$options","isEdit","_createVNode","_component_el_form","model","$data","form","rules","ref","_withCtx","_component_el_form_item","label","prop","_component_el_input","modelValue","name","_cache","$event","placeholder","_","description","type","_hoisted_3","_component_MonacoEditor","sqlCode","language","options","editorOptions","onSave","handleSave","_hoisted_4","_component_el_tag","size","_createTextVNode","_hoisted_5","pythonCode","_hoisted_6","_component_el_button","onClick","cancel"],"sources":["/Users/guojingjing/2024-ai-code/crm/frontend/src/views/strategy/StrategyEdit.vue"],"sourcesContent":["<template>\n  <div class=\"strategy-edit\">\n    <div class=\"header\">\n      <h2>{{ isEdit ? '编辑策略' : '新建策略' }}</h2>\n    </div>\n    \n    <el-form :model=\"form\" label-width=\"120px\" :rules=\"rules\" ref=\"formRef\">\n      <el-form-item label=\"策略名称\" prop=\"name\">\n        <el-input v-model=\"form.name\" placeholder=\"请输入策略名称\" />\n      </el-form-item>\n      \n      <el-form-item label=\"策略描述\" prop=\"description\">\n        <el-input v-model=\"form.description\" type=\"textarea\" placeholder=\"请输入策略描述\" />\n      </el-form-item>\n      \n      <el-form-item label=\"SQL代码\" prop=\"sqlCode\">\n        <div class=\"editor-container\">\n          <MonacoEditor\n            v-model=\"form.sqlCode\"\n            language=\"sql\"\n            :options=\"editorOptions\"\n            @save=\"handleSave\"\n          />\n        </div>\n        <div class=\"editor-tips\">\n          <el-tag size=\"small\">按 Ctrl+S (Mac: Cmd+S) 保存</el-tag>\n          <el-tag size=\"small\" type=\"info\">支持 SQL 代码提示</el-tag>\n        </div>\n      </el-form-item>\n      \n      <el-form-item label=\"Python代码\" prop=\"pythonCode\">\n        <div class=\"editor-container\">\n          <MonacoEditor\n            v-model=\"form.pythonCode\"\n            language=\"python\"\n            :options=\"editorOptions\"\n            @save=\"handleSave\"\n          />\n        </div>\n        <div class=\"editor-tips\">\n          <el-tag size=\"small\">按 Ctrl+S (Mac: Cmd+S) 保存</el-tag>\n          <el-tag size=\"small\" type=\"info\">支持 Python 代码提示</el-tag>\n        </div>\n      </el-form-item>\n      \n      <el-form-item>\n        <el-button type=\"primary\" @click=\"handleSave\">保存</el-button>\n        <el-button @click=\"cancel\">取消</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport MonacoEditor from '@/components/MonacoEditor.vue'\nimport { strategyApi } from '@/api/strategy'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'StrategyEdit',\n  components: {\n    MonacoEditor\n  },\n  data() {\n    return {\n      form: {\n        name: '',\n        description: '',\n        sqlCode: '',\n        pythonCode: ''\n      },\n      rules: {\n        name: [\n          { required: true, message: '请输入策略名称', trigger: 'blur' },\n          { min: 2, max: 50, message: '长度在 2 到 50 个字符', trigger: 'blur' }\n        ],\n        description: [\n          { required: true, message: '请输入策略描述', trigger: 'blur' }\n        ],\n        sqlCode: [\n          { required: true, message: '请输入SQL代码', trigger: 'blur' }\n        ],\n        pythonCode: [\n          { required: true, message: '请输入Python代码', trigger: 'blur' }\n        ]\n      },\n      editorOptions: {\n        theme: 'customTheme',\n        minimap: { enabled: false },\n        scrollBeyondLastLine: false,\n        fontSize: 14,\n        automaticLayout: true,\n        tabSize: 4,\n        formatOnPaste: true,\n        formatOnType: true\n      }\n    }\n  },\n  setup() {\n    const formRef = ref(null)\n    return { formRef }\n  },\n  computed: {\n    isEdit() {\n      return this.$route.params.id !== undefined\n    }\n  },\n  methods: {\n    async handleSave() {\n      if (!this.formRef) return\n      \n      try {\n        await this.formRef.validate()\n        \n        if (this.isEdit) {\n          await strategyApi.updateStrategy(this.$route.params.id, this.form)\n          ElMessage.success('策略更新成功')\n        } else {\n          await strategyApi.createStrategy(this.form)\n          ElMessage.success('策略创建成功')\n        }\n        \n        this.$router.push('/strategy')\n      } catch (error) {\n        if (error.name === 'ValidationError') {\n          ElMessage.error('请检查表单填写是否正确')\n        } else {\n          ElMessage.error('保存失败：' + error.message)\n        }\n      }\n    },\n    cancel() {\n      this.$router.push('/strategy')\n    },\n    async loadStrategy() {\n      if (!this.isEdit) return\n      \n      try {\n        const response = await strategyApi.getStrategy(this.$route.params.id)\n        this.form = response.data\n      } catch (error) {\n        ElMessage.error('加载策略失败：' + error.message)\n        this.$router.push('/strategy')\n      }\n    }\n  },\n  mounted() {\n    this.loadStrategy()\n  }\n}\n</script>\n\n<style scoped>\n.strategy-edit {\n  padding: 20px;\n}\n.header {\n  margin-bottom: 20px;\n}\n.editor-container {\n  height: 300px;\n  border: 1px solid #dcdfe6;\n  border-radius: 4px;\n}\n.editor-tips {\n  margin-top: 8px;\n  display: flex;\n  gap: 8px;\n}\n.el-tag {\n  font-size: 12px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}